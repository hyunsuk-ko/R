TRUE ~ TRUE)) %>%
select(actor,partner,with_partner,everything())
chimps %>%
select(actor, partner, with_partner, prosocial, selfish) %>%
filter(with_partner == TRUE)
chimps
chimps <- read_csv("../../data/chimpanzee.csv") %>%
mutate(with_partner = case_when(
partner == "none" ~ FALSE,
TRUE ~ TRUE)) %>%
select(actor,partner,with_partner,everything())
chimps %>%
select(actor, partner, with_partner, prosocial, selfish) %>%
filter(with_partner == TRUE)
chimps <- read_csv("../../data/chimpanzee.csv") %>%
mutate(with_partner = case_when(
partner == "none" ~ FALSE,
TRUE ~ TRUE)) %>%
select(actor,partner,with_partner,everything())
chimps %>%
select(actor, partner, with_partner, prosocial, selfish) %>%
filter(with_partner == TRUE) %>%
mutate(n = prosocial+selfish)
chimps <- read_csv("../../data/chimpanzee.csv") %>%
mutate(with_partner = case_when(
partner == "none" ~ FALSE,
TRUE ~ TRUE)) %>%
select(actor,partner,with_partner,everything())
chimps_partner<- chimps %>%
select(actor, partner, with_partner, prosocial, selfish) %>%
filter(with_partner == TRUE) %>%
mutate(n = prosocial+selfish)
chimps_partner
chimps <- read_csv("../../data/chimpanzee.csv") %>%
mutate(with_partner = case_when(
partner == "none" ~ FALSE,
TRUE ~ TRUE)) %>%
select(actor,partner,with_partner,everything())
chimps_partner<- chimps %>%
select(actor, partner, with_partner, prosocial, selfish) %>%
filter(with_partner == TRUE) %>%
mutate(n = prosocial+selfish)
chimps_partner
gbinom(90,0.5,scale=TRUE, size = 2) +
geom_vline(xintercept=60,color="red",
linetype="dashed", size = 2) +
theme_bw()
chimps <- read_csv("../../data/chimpanzee.csv") %>%
mutate(with_partner = case_when(
partner == "none" ~ FALSE,
TRUE ~ TRUE)) %>%
select(actor,partner,with_partner,everything())
chimps_partner<- chimps %>%
select(actor, partner, with_partner, prosocial, selfish) %>%
filter(with_partner == TRUE) %>%
mutate(n = prosocial+selfish)
chimps_partner
gbinom(90,0.5,scale=TRUE, size = 2) +
geom_vline(xintercept=60,color="red",
linetype="dashed", size = 2) +
geom_vline(xintercept=30,color="red",
linetype="dashed", size = 2) +
theme_bw()
chimps <- read_csv("../../data/chimpanzee.csv") %>%
mutate(with_partner = case_when(
partner == "none" ~ FALSE,
TRUE ~ TRUE)) %>%
select(actor,partner,with_partner,everything())
chimps_partner<- chimps %>%
select(actor, partner, with_partner, prosocial, selfish) %>%
filter(with_partner == TRUE) %>%
mutate(n = prosocial+selfish)
chimps_partner
gbinom(90,0.5,scale=TRUE, size = 2) +
geom_vline(xintercept=60,color="red",
linetype="dashed", size = 2) +
geom_vline(xintercept=30,color="red",
linetype="dashed", size = 2) +
theme_bw()
tol <- 1.0e-07 ## 10 ^(-7)
x <- 0:90
x_extreme <- x[dbinom(x,90,0.5) < dbinom(60,90,0.5) + tol]
p_value <- sum(dbinom(x_extreme,90,0.5))
p_value
chimps <- read_csv("../../data/chimpanzee.csv") %>%
mutate(with_partner = case_when(
partner == "none" ~ FALSE,
TRUE ~ TRUE)) %>%
select(actor,partner,with_partner,everything())
chimps_partner<- chimps %>%
select(actor, partner, with_partner, prosocial, selfish) %>%
filter(with_partner == TRUE) %>%
mutate(n = prosocial+selfish)
gbinom(90,0.5,scale=TRUE, size = 2) +
geom_vline(xintercept=60,color="red",
linetype="dashed", size = 2) +
geom_vline(xintercept=30,color="red",
linetype="dashed", size = 2) +
theme_bw()
tol <- 1.0e-07 ## 10 ^(-7)
x <- 0:90
x_extreme <- x[dbinom(x,90,0.5) < dbinom(60,90,0.5) + tol]
p_value <- sum(dbinom(x_extreme,90,0.5))
p_value
chimps_nopartner <- chimps %>%
select(actor, partner, with_partner, prosocial, selfish) %>%
filter(with_partner == FALSE) %>%
mutate(n = prosocial+selfish)
gbinom(90,0.5,scale=TRUE, size = 2) +
geom_vline(xintercept=60,color="red",
linetype="dashed", size = 2) +
geom_vline(xintercept=30,color="red",
linetype="dashed", size = 2) +
theme_bw()
tol <- 1.0e-07 ## 10 ^(-7)
x <- 0:90
x_extreme <- x[dbinom(x,90,0.5) < dbinom(60,90,0.5) + tol]
p_value <- sum(dbinom(x_extreme,90,0.5))
p_value
chimps_nopartner
chimps_nopartner <- chimps %>%
select(actor, partner, with_partner, prosocial, selfish) %>%
filter(with_partner == FALSE) %>%
mutate(n = prosocial+selfish)
gbinom(30,0.5,scale=TRUE, size = 2) +
geom_vline(xintercept=20,color="red",
linetype="dashed", size = 2) +
geom_vline(xintercept=10,color="red",
linetype="dashed", size = 2) +
theme_bw()
tol <- 1.0e-07 ## 10 ^(-7)
x <- 0:90
x_extreme <- x[dbinom(x,90,0.5) < dbinom(60,90,0.5) + tol]
p_value <- sum(dbinom(x_extreme,90,0.5))
p_value
chimps_nopartner <- chimps %>%
select(actor, partner, with_partner, prosocial, selfish) %>%
filter(with_partner == FALSE) %>%
mutate(n = prosocial+selfish)
gbinom(30,0.5,scale=TRUE, size = 2) +
geom_vline(xintercept=20,color="red",
linetype="dashed", size = 2) +
geom_vline(xintercept=10,color="red",
linetype="dashed", size = 2) +
theme_bw()
tol <- 1.0e-07 ## 10 ^(-7)
x <- 0:30
x_extreme <- x[dbinom(x,30,0.5) < dbinom(20,30,0.5) + tol]
p_value <- sum(dbinom(x_extreme,30,0.5))
p_value
chimps_nopartner <- chimps %>%
select(actor, partner, with_partner, prosocial, selfish) %>%
filter(with_partner == FALSE) %>%
mutate(n = prosocial+selfish)
gbinom(30,0.5,scale=TRUE, size = 2) +
geom_vline(xintercept=20,color="red",
linetype="dashed", size = 2) +
geom_vline(xintercept=10,color="red",
linetype="dashed", size = 2) +
theme_bw()
tol <- 1.0e-07 ## 10 ^(-7)
x <- 0:30
x_extreme <- x[dbinom(x,30,0.5) < dbinom(20,30,0.5) + tol]
p_value <- sum(dbinom(x_extreme,30,0.5))
p_value
knitr::opts_chunk$set(echo = TRUE, message=FALSE)
library(tidyverse)
library(lubridate)
source("../../scripts/viridis.R")
source("../../scripts/ggprob.R")
chimps <- read_csv("../../data/chimpanzee.csv") %>%
mutate(with_partner = case_when(
partner == "none" ~ FALSE,
TRUE ~ TRUE)) %>%
select(actor,partner,with_partner,everything())
chimps_partner <- chimps %>%
select(actor, partner, with_partner, prosocial, selfish) %>%
filter(with_partner == TRUE) %>%
mutate(n = prosocial+selfish)
gbinom(90,0.5,scale=TRUE, size = 2) +
geom_vline(xintercept=60,color="red",
linetype="dashed", size = 2) +
geom_vline(xintercept=30,color="red",
linetype="dashed", size = 2) +
theme_bw()
tol <- 1.0e-07 ## 10 ^(-7)
x <- 0:90
x_extreme <- x[dbinom(x,90,0.5) < dbinom(60,90,0.5) + tol]
p_value <- sum(dbinom(x_extreme,90,0.5))
p_value
knitr::opts_chunk$set(echo = TRUE, message=FALSE)
library(tidyverse)
library(lubridate)
source("../../scripts/viridis.R")
source("../../scripts/ggprob.R")
chimps_nopartner <- chimps %>%
select(actor, partner, with_partner, prosocial, selfish) %>%
filter(with_partner == FALSE) %>%
mutate(n = prosocial+selfish) %>%
summarize(prosocial=sum(prosocial),
selfish=sum(selfish),
n=selfish+prosocial)
knitr::opts_chunk$set(echo = TRUE, message=FALSE)
library(tidyverse)
library(lubridate)
source("../../scripts/viridis.R")
source("../../scripts/ggprob.R")
chimps <- read_csv("../../data/chimpanzee.csv") %>%
mutate(with_partner = case_when(
partner == "none" ~ FALSE,
TRUE ~ TRUE)) %>%
select(actor,partner,with_partner,everything())
chimps_partner <- chimps %>%
select(actor, partner, with_partner, prosocial, selfish) %>%
filter(with_partner == TRUE) %>%
mutate(n = prosocial+selfish) %>%
summarize(prosocial=sum(prosocial),
selfish=sum(selfish),
n=selfish+prosocial)
n <- chimps_partner$n
prosocial <- chimps_partner$prosocial
tol <- 1.0e-07 ## 10 ^(-7)
x <- 0:n
x_extreme <- x[dbinom(x,n,0.5) < dbinom(prosocial,n,0.5) + tol]
p_value <- sum(dbinom(x_extreme,n,0.5))
p_value
gbinom(n,0.5,scale=TRUE, size = 2) +
geom_vline(xintercept=prosocial,color="red",
linetype="dashed", size = 2) +
geom_vline(xintercept=n-prosocial,color="red",
linetype="dashed", size = 2) +
geom_hline(yintercept=p_value,color="purple",
linetype="dashed", size = 2, label="p_value") +
theme_bw()
knitr::opts_chunk$set(echo = TRUE, message=FALSE)
library(tidyverse)
library(lubridate)
source("../../scripts/viridis.R")
source("../../scripts/ggprob.R")
chimps <- read_csv("../../data/chimpanzee.csv") %>%
mutate(with_partner = case_when(
partner == "none" ~ FALSE,
TRUE ~ TRUE)) %>%
select(actor,partner,with_partner,everything())
chimps_partner <- chimps %>%
select(actor, partner, with_partner, prosocial, selfish) %>%
filter(with_partner == TRUE) %>%
mutate(n = prosocial+selfish) %>%
summarize(prosocial=sum(prosocial),
selfish=sum(selfish),
n=selfish+prosocial)
n <- chimps_partner$n
prosocial <- chimps_partner$prosocial
tol <- 1.0e-07 ## 10 ^(-7)
x <- 0:n
x_extreme <- x[dbinom(x,n,0.5) < dbinom(prosocial,n,0.5) + tol]
p_value <- sum(dbinom(x_extreme,n,0.5))
p_value
gbinom(n,0.5,scale=TRUE, size = 2) +
geom_vline(xintercept=prosocial,color="red",
linetype="dashed", size = 2) +
geom_vline(xintercept=n-prosocial,color="red",
linetype="dashed", size = 2) +
geom_hline(yintercept=p_value,color="purple",
linetype="dashed", size = 2, label="p_value") +
theme_bw()
chimps_nopartner <- chimps %>%
select(actor, partner, with_partner, prosocial, selfish) %>%
filter(with_partner == FALSE) %>%
mutate(n = prosocial+selfish) %>%
summarize(prosocial=sum(prosocial),
selfish=sum(selfish),
n=selfish+prosocial)
n <- chimps_nopartner$n
prosocial <- chimps_nopartner$prosocial
tol <- 1.0e-07 ## 10 ^(-7)
x <- 0:n
x_extreme <- x[dbinom(x,n,0.5) < dbinom(prosocial,n,0.5) + tol]
p_value <- sum(dbinom(x_extreme,n,0.5))
p_value
gbinom(n,0.5,scale=TRUE, size = 2) +
geom_vline(xintercept=prosocial,color="red",
linetype="dashed", size = 2) +
geom_vline(xintercept=n-prosocial,color="red",
linetype="dashed", size = 2) +
geom_hline(yintercept=p_value, color="purple",
linetype="dashed")
theme_bw()
chimps_nopartner <- chimps %>%
select(actor, partner, with_partner, prosocial, selfish) %>%
filter(with_partner == FALSE) %>%
mutate(n = prosocial+selfish) %>%
summarize(prosocial=sum(prosocial),
selfish=sum(selfish),
n=selfish+prosocial)
n <- chimps_nopartner$n
prosocial <- chimps_nopartner$prosocial
tol <- 1.0e-07 ## 10 ^(-7)
x <- 0:n
x_extreme <- x[dbinom(x,n,0.5) < dbinom(prosocial,n,0.5) + tol]
p_value <- sum(dbinom(x_extreme,n,0.5))
p_value
gbinom(n,0.5,scale=TRUE, size = 2) +
geom_vline(xintercept=prosocial,color="red",
linetype="dashed", size = 1) +
geom_vline(xintercept=n-prosocial,color="red",
linetype="dashed", size = 1) +
geom_hline(yintercept=p_value, color="purple",
linetype="dashed", size=2)
theme_bw()
chimps_nopartner <- chimps %>%
select(actor, partner, with_partner, prosocial, selfish) %>%
filter(with_partner == FALSE) %>%
mutate(n = prosocial+selfish) %>%
summarize(prosocial=sum(prosocial),
selfish=sum(selfish),
n=selfish+prosocial)
n <- chimps_nopartner$n
prosocial <- chimps_nopartner$prosocial
tol <- 1.0e-07 ## 10 ^(-7)
x <- 0:n
x_extreme <- x[dbinom(x,n,0.5) < dbinom(prosocial,n,0.5) + tol]
p_value <- sum(dbinom(x_extreme,n,0.5))
p_value
gbinom(n,0.5,scale=TRUE, size = 2) +
geom_vline(xintercept=prosocial,color="red",
linetype="dashed", size = 1) +
geom_vline(xintercept=n-prosocial,color="red",
linetype="dashed", size = 1) +
geom_hline(yintercept=p_value, color="purple",
linetype="dashed", size=2) +
theme_bw()
chimps <- read_csv("../../data/chimpanzee.csv") %>%
mutate(with_partner = case_when(
partner == "none" ~ FALSE,
TRUE ~ TRUE)) %>%
select(actor,partner,with_partner,everything())
chimps_partner <- chimps %>%
select(actor, partner, with_partner, prosocial, selfish) %>%
filter(with_partner == TRUE) %>%
mutate(n = prosocial+selfish) %>%
summarize(prosocial=sum(prosocial),
selfish=sum(selfish),
n=selfish+prosocial)
n <- chimps_partner$n
prosocial <- chimps_partner$prosocial
tol <- 1.0e-07 ## 10 ^(-7)
x <- 0:n
x_extreme <- x[dbinom(x,n,0.5) < dbinom(prosocial,n,0.5) + tol]
p_value <- sum(dbinom(x_extreme,n,0.5))
p_value
gbinom(n,0.5,scale=TRUE, size = 2) +
geom_vline(xintercept=prosocial,color="red",
linetype="dashed", size = 1) +
geom_vline(xintercept=n-prosocial,color="red",
linetype="dashed", size = 1) +
geom_hline(yintercept=p_value,color="purple",
linetype="dashed", size = 2, label="p_value") +
theme_bw()
chimps
chimps %>%
summarize(prosocial=sum(prosocial),
selfish=sum(selfish),
n=prosocial+selfish)
chimp_summary<- chimps %>%
summarize(prosocial=sum(prosocial),
selfish=sum(selfish),
n=prosocial+selfish)
p = chimp_summary$prosocial / chimp_summary$n
p
N <- 10000
chimps
N <- 10000
chimps_partner
chimps_nopartner
N <- 10000
chimp_df <- chimps %>%
group_by(with_patner) %>%
summarize(prosocial = sum(prosocial),
selfish = sum(selfish),
n = prosocial + selfish,
p_hat = prosocial / n)
chimps
N <- 10000
chimp_df <- chimps %>%
group_by(with_partner) %>%
summarize(prosocial = sum(prosocial),
selfish = sum(selfish),
n = prosocial + selfish,
p_hat = prosocial / n)
chimp_df
View(chimp_df)
View(chimp_summary)
View(chimps)
View(chimps_nopartner)
chimp_summary
chimp_summary<- chimps %>%
summarize(prosocial=sum(prosocial),
selfish=sum(selfish),
n=prosocial+selfish,
p_hat = prosocial/n)
p = chimp_summary$prosocial / chimp_summary$n
p
chimp_summary
chimp_summary<- chimps %>%
summarize(prosocial=sum(prosocial),
selfish=sum(selfish),
n=prosocial+selfish,
p_hat = prosocial/n)
p = chimp_summary$p_hat
p
chimp_summary
N <- 10000
chimp_df <- chimps %>%
group_by(with_partner) %>%
summarize(prosocial = sum(prosocial),
selfish = sum(selfish),
n = prosocial + selfish,
p_hat = prosocial / n)
chimp_df
diff_df <- tibble(
p_hat_1 = rbinom(N, 610, chimp_summary$p_hat) / 610,
p_hat_2 = rbinom(N, 180, chimp_summary$p_hat) / 180,
diff= p_hat_1 - p_hat_2,
)
diff_df
N <- 10000
chimp_df <- chimps %>%
group_by(with_partner) %>%
summarize(prosocial = sum(prosocial),
selfish = sum(selfish),
n = prosocial + selfish,
p_hat = prosocial / n)
chimp_df
diff_df <- tibble(
p_hat_1 = rbinom(N, 610, chimp_summary$p_hat) / 610,
p_hat_2 = rbinom(N, 180, chimp_summary$p_hat) / 180,
diff= p_hat_1 - p_hat_2,
extreme = abs(diff) >= abs()
)
N <- 10000
chimp_df <- chimps %>%
group_by(with_partner) %>%
summarize(prosocial = sum(prosocial),
selfish = sum(selfish),
n = prosocial + selfish,
p_hat = prosocial / n)
chimp_df
diff_df <- tibble(
p_hat_1 = rbinom(N, 610, chimp_summary$p_hat) / 610,
p_hat_2 = rbinom(N, 180, chimp_summary$p_hat) / 180,
diff= p_hat_1 - p_hat_2,
extreme = abs(diff) >= abs(chimp_df$p_hat[2] - chimp_df$p_hat[1])
)
diff_df
N <- 10000
chimp_df <- chimps %>%
group_by(with_partner) %>%
summarize(prosocial = sum(prosocial),
selfish = sum(selfish),
n = prosocial + selfish,
p_hat = prosocial / n)
chimp_df
diff_df <- tibble(
p_hat_1 = rbinom(N, 610, chimp_summary$p_hat) / 610,
p_hat_2 = rbinom(N, 180, chimp_summary$p_hat) / 180,
diff= p_hat_1 - p_hat_2,
extreme = abs(diff) >= abs(chimp_df$p_hat[2] - chimp_df$p_hat[1])
)
diff_df
p_value_e <- mean(df_e$extreme)
N <- 10000
chimp_df <- chimps %>%
group_by(with_partner) %>%
summarize(prosocial = sum(prosocial),
selfish = sum(selfish),
n = prosocial + selfish,
p_hat = prosocial / n)
chimp_df
diff_df <- tibble(
p_hat_1 = rbinom(N, 610, chimp_summary$p_hat) / 610,
p_hat_2 = rbinom(N, 180, chimp_summary$p_hat) / 180,
diff= p_hat_1 - p_hat_2,
extreme = abs(diff) >= abs(chimp_df$p_hat[2] - chimp_df$p_hat[1])
)
diff_df
p_value_e <- mean(diff_df$extreme)
p_value_e
N <- 10000
chimp_df <- chimps %>%
group_by(with_partner) %>%
summarize(prosocial = sum(prosocial),
selfish = sum(selfish),
n = prosocial + selfish,
p_hat = prosocial / n)
diff_df <- tibble(
p_hat_1 = rbinom(N, 610, chimp_summary$p_hat) / 610,
p_hat_2 = rbinom(N, 180, chimp_summary$p_hat) / 180,
diff= p_hat_1 - p_hat_2,
extreme = abs(diff) >= abs(chimp_df$p_hat[2] - chimp_df$p_hat[1])
)
p_value_e <- mean(diff_df$extreme)
sd <- sd(diff_df$extreme)
p_value_e
sd
ggplot(diff_df, aes(x=diff)) +
geom_density() +
geom_vline(xintercept = chimp_df$p_hat[2] - chimp_df$p_hat[1],color='red')+
theme_bw()
diff = chimp_df$p_hat[2] - chimp_df$p_hat[1]
random_diff = (rbinom(N,610,chimp_summary$p_hat) / 610)-(rbinom(N,180,chimp_summary$p_hat) / 180)
mean(abs(random_diff)>=diff)
