arrange(date, hour)
rm(ord_2016, ord_2017, ord_2018, ord_2019, ord_2020)
str(ord)
knitr::opts_chunk$set(echo = TRUE,message=FALSE)
library(tidyverse)
library(scales)
library(lubridate)
source("../../scripts/viridis.R")
Sys.setlocale("LC_TIME", "English_United States.1252")
ord_2016 <- read.csv("../../data/ORD-2016.csv")
ord_2017 <- read.csv("../../data/ORD-2017.csv")
ord_2018 <- read.csv("../../data/ORD-2018.csv")
ord_2019 <- read.csv("../../data/ORD-2019.csv")
ord_2020 <- read.csv("../../data/ORD-2020.csv")
ord_2016 <- ord_2016 %>% mutate(date=mdy(date))
ord_2017 <- ord_2017 %>% mutate(date=mdy(date))
ord_2018 <- ord_2018 %>% mutate(date=mdy(date))
ord_2019 <- ord_2019 %>% mutate(date=ymd(date))
ord_2020 <- ord_2020 %>% mutate(date=ymd(date))
ord <- bind_rows(ord_2016, ord_2017, ord_2018, ord_2019, ord_2020)
ord <- ord %>%
mutate(year=year(date), month=month(date, label=TRUE), day=day(date), wday=wday(date, label=TRUE)) %>%
relocate(year, .after=date) %>%
relocate(month, .after=year) %>%
relocate(day, .after=month) %>%
relocate(wday, .after=day) %>%
select(-terminal) %>%
rename(passengers=all_total, flights=all_flights, booths=all_booths) %>%
arrange(date, hour)
rm(ord_2016, ord_2017, ord_2018, ord_2019, ord_2020)
str(ord)
count_na <- function(x){
return (sum(is.na(x)))
}
count_na(ord)
ord_summary <- ord %>%
group_by(year) %>%
summarize(tot_flights=sum(flights), tot_passengers=sum(passengers)) %>%
select(year, tot_flights, tot_passengers)
ord_summary
weekend_data <- ord %>%
mutate(weekend=ifelse(wday=="Sat" | wday=="Sun", "TRUE", "FALSE")) %>%
select(year, weekend, wday, us_avg_wait, non_us_avg_wait)
weekend_data
weekend_data <- ord %>%
mutate(weekend=ifelse(wday=="Sat" | wday=="Sun", "TRUE", "FALSE")) %>%
select(year, weekend, wday, us_avg_wait, non_us_avg_wait)
weekend_data
ggplot(weekend_data,aes(x=us_avg_wait, y=non_us_avg_wait, color=weekend)) +
geom_point()
weekend_data <- ord %>%
mutate(weekend=ifelse(wday=="Sat" | wday=="Sun", "TRUE", "FALSE")) %>%
select(year, weekend, wday, us_avg_wait, non_us_avg_wait)
weekend_data
ggplot(weekend_data,aes(x=us_avg_wait, y=non_us_avg_wait, color=weekend)) +
geom_point() +
geom_smooth(method="lm")
weekend_data <- ord %>%
mutate(weekend=ifelse(wday=="Sat" | wday=="Sun", "TRUE", "FALSE")) %>%
select(year, weekend, wday, us_avg_wait, non_us_avg_wait)
weekend_data
ggplot(weekend_data,aes(x=us_avg_wait, y=non_us_avg_wait, color=weekend)) +
geom_point() +
geom_smooth(method="lm") +
facet_wrap(~year) +
weekend_data <- ord %>%
mutate(weekend=ifelse(wday=="Sat" | wday=="Sun", "TRUE", "FALSE")) %>%
select(year, weekend, wday, us_avg_wait, non_us_avg_wait)
weekend_data
ggplot(weekend_data,aes(x=us_avg_wait, y=non_us_avg_wait, color=weekend)) +
geom_point() +
geom_smooth(method="lm") +
facet_wrap(~year)
weekend_data <- ord %>%
mutate(weekend=ifelse(wday=="Sat" | wday=="Sun", "TRUE", "FALSE")) %>%
select(year, weekend, wday, us_avg_wait, non_us_avg_wait)
weekend_data
ggplot(weekend_data,aes(x=us_avg_wait, y=non_us_avg_wait, color=weekend)) +
geom_point() +
geom_smooth(method="lm") +
facet_wrap(~year) +
scale_color_discrete(name = "Weekend & Weekdays", labels = c("TRUE" = "Weekend","FALSE" = "Weekday"))
data <- ord %>%
group_by(year) %>%
summarize(us=mean(us_avg_wait), non_us=mean(non_us_avg_wait)) %>%
select(year, us, non_us)
data <- ord %>%
group_by(year) %>%
summarize(us=mean(us_avg_wait), non_us=mean(non_us_avg_wait)) %>%
select(year, us, non_us)
data
data <- ord %>%
group_by(year) %>%
summarize(us=avg(us_avg_wait), non_us=avg(non_us_avg_wait)) %>%
select(year, us, non_us)
data <- ord %>%
group_by(year) %>%
summarize(us=mean(us_avg_wait), non_us=mean(non_us_avg_wait)) %>%
select(year, us, non_us)
data
ord <- ord %>%
mutate(booth_rate = (passengers/booths) / (all_avg_wait / 60) )
ord <- ord %>%
mutate(booth_rate = (passengers/booths) / (all_avg_wait / 60),
time_of_day=
case_when(
(hour == "0100 - 0200" | hour == "0200 - 0300" | hour == "0300 - 0400" | hour == "0400 - 0500" ~ 'overnight'),
(hour == "0500 - 0600" | hour == "0600 - 0700" | hour == "0700 - 0800" ~ 'early morning'),
(hour == "0800 - 0900" | hour == "0900 - 1000" | hour == "1000 - 1100" | hour == "1100 - 1200" ~ 'morning'),
(hour == "1200 - 1300" | hour == "1300 - 1400" | hour == "1400 - 1500" | hour == "1500 - 1600" | hour == "1600 - 1700" ~ 'afternoon'),
(hour == "1700 - 1800" | hour == "1800 - 1900" | hour == "1900 - 2000" ~ 'early evening'),
(hour == "2000 - 2100" | hour == "2100 - 2200" | hour == "2200 - 2300" | hour == "2300 - 0000" | hour == "0000 - 0100"~ 'late evening'))
)
q7_data1 <- ord %>%
mutate(booth_rate = (passengers/booths) / (all_avg_wait / 60),
time_of_day=
case_when(
(hour == "0100 - 0200" | hour == "0200 - 0300" | hour == "0300 - 0400" | hour == "0400 - 0500" ~ 'overnight'),
(hour == "0500 - 0600" | hour == "0600 - 0700" | hour == "0700 - 0800" ~ 'early morning'),
(hour == "0800 - 0900" | hour == "0900 - 1000" | hour == "1000 - 1100" | hour == "1100 - 1200" ~ 'morning'),
(hour == "1200 - 1300" | hour == "1300 - 1400" | hour == "1400 - 1500" | hour == "1500 - 1600" | hour == "1600 - 1700" ~'afternoon'),
(hour == "1700 - 1800" | hour == "1800 - 1900" | hour == "1900 - 2000" ~ 'early evening'),
(hour == "2000 - 2100" | hour == "2100 - 2200" | hour == "2200 - 2300" | hour == "2300 - 0000" | hour == "0000 - 0100"~ 'late evening'))) %>%
filter( (passengers>=200) | (avg_wait_time != 0) | (booth_rate<=500) )
q7_data1 <- ord %>%
mutate(booth_rate = (passengers/booths) / (all_avg_wait / 60),
time_of_day=
case_when(
(hour == "0100 - 0200" | hour == "0200 - 0300" | hour == "0300 - 0400" | hour == "0400 - 0500" ~ 'overnight'),
(hour == "0500 - 0600" | hour == "0600 - 0700" | hour == "0700 - 0800" ~ 'early morning'),
(hour == "0800 - 0900" | hour == "0900 - 1000" | hour == "1000 - 1100" | hour == "1100 - 1200" ~ 'morning'),
(hour == "1200 - 1300" | hour == "1300 - 1400" | hour == "1400 - 1500" | hour == "1500 - 1600" | hour == "1600 - 1700" ~'afternoon'),
(hour == "1700 - 1800" | hour == "1800 - 1900" | hour == "1900 - 2000" ~ 'early evening'),
(hour == "2000 - 2100" | hour == "2100 - 2200" | hour == "2200 - 2300" | hour == "2300 - 0000" | hour == "0000 - 0100"~ 'late evening'))) %>%
filter( (passengers>=200) | (all_avg_wait != 0) | (booth_rate<=500) )
ggplot(q7_data1,aes(x=wday, y=booth_rate)) +
geom_boxplot()
q7_data1 <- ord %>%
mutate(booth_rate = (passengers/booths) / (all_avg_wait / 60),
time_of_day=
case_when(
(hour == "0100 - 0200" | hour == "0200 - 0300" | hour == "0300 - 0400" | hour == "0400 - 0500" ~ 'overnight'),
(hour == "0500 - 0600" | hour == "0600 - 0700" | hour == "0700 - 0800" ~ 'early morning'),
(hour == "0800 - 0900" | hour == "0900 - 1000" | hour == "1000 - 1100" | hour == "1100 - 1200" ~ 'morning'),
(hour == "1200 - 1300" | hour == "1300 - 1400" | hour == "1400 - 1500" | hour == "1500 - 1600" | hour == "1600 - 1700" ~'afternoon'),
(hour == "1700 - 1800" | hour == "1800 - 1900" | hour == "1900 - 2000" ~ 'early evening'),
(hour == "2000 - 2100" | hour == "2100 - 2200" | hour == "2200 - 2300" | hour == "2300 - 0000" | hour == "0000 - 0100"~ 'late evening'))) %>%
filter( (passengers>=200) | (all_avg_wait != 0) | (booth_rate<=500) )
ggplot(q7_data1,aes(x=wday, y=booth_rate, color=wday)) +
geom_boxplot()
q7_data1 <- ord %>%
mutate(booth_rate = (passengers/booths) / (all_avg_wait / 60),
time_of_day=
case_when(
(hour == "0100 - 0200" | hour == "0200 - 0300" | hour == "0300 - 0400" | hour == "0400 - 0500" ~ 'overnight'),
(hour == "0500 - 0600" | hour == "0600 - 0700" | hour == "0700 - 0800" ~ 'early morning'),
(hour == "0800 - 0900" | hour == "0900 - 1000" | hour == "1000 - 1100" | hour == "1100 - 1200" ~ 'morning'),
(hour == "1200 - 1300" | hour == "1300 - 1400" | hour == "1400 - 1500" | hour == "1500 - 1600" | hour == "1600 - 1700" ~'afternoon'),
(hour == "1700 - 1800" | hour == "1800 - 1900" | hour == "1900 - 2000" ~ 'early evening'),
(hour == "2000 - 2100" | hour == "2100 - 2200" | hour == "2200 - 2300" | hour == "2300 - 0000" | hour == "0000 - 0100"~ 'late evening'))) %>%
filter( (passengers>=200) | (all_avg_wait != 0) | (booth_rate<=500) )
ggplot(q7_data1,aes(x=wday, y=booth_rate, color=(ifelse(wday=='Sat'| wday=='Sun), gray, white) ) +
geom_boxplot()
q7_data1 <- ord %>%
mutate(booth_rate = (passengers/booths) / (all_avg_wait / 60),
time_of_day=
case_when(
(hour == "0100 - 0200" | hour == "0200 - 0300" | hour == "0300 - 0400" | hour == "0400 - 0500" ~ 'overnight'),
(hour == "0500 - 0600" | hour == "0600 - 0700" | hour == "0700 - 0800" ~ 'early morning'),
(hour == "0800 - 0900" | hour == "0900 - 1000" | hour == "1000 - 1100" | hour == "1100 - 1200" ~ 'morning'),
(hour == "1200 - 1300" | hour == "1300 - 1400" | hour == "1400 - 1500" | hour == "1500 - 1600" | hour == "1600 - 1700" ~'afternoon'),
(hour == "1700 - 1800" | hour == "1800 - 1900" | hour == "1900 - 2000" ~ 'early evening'),
(hour == "2000 - 2100" | hour == "2100 - 2200" | hour == "2200 - 2300" | hour == "2300 - 0000" | hour == "0000 - 0100"~ 'late evening'))) %>%
filter( (passengers>=200) | (all_avg_wait != 0) | (booth_rate<=500) )
ggplot(q7_data1,aes(x=wday, y=booth_rate, color=(ifelse(wday=='Sat'| wday=='Sun'), gray, white) ) +
q7_data1 <- ord %>%
mutate(booth_rate = (passengers/booths) / (all_avg_wait / 60),
time_of_day=
case_when(
(hour == "0100 - 0200" | hour == "0200 - 0300" | hour == "0300 - 0400" | hour == "0400 - 0500" ~ 'overnight'),
(hour == "0500 - 0600" | hour == "0600 - 0700" | hour == "0700 - 0800" ~ 'early morning'),
(hour == "0800 - 0900" | hour == "0900 - 1000" | hour == "1000 - 1100" | hour == "1100 - 1200" ~ 'morning'),
(hour == "1200 - 1300" | hour == "1300 - 1400" | hour == "1400 - 1500" | hour == "1500 - 1600" | hour == "1600 - 1700" ~'afternoon'),
(hour == "1700 - 1800" | hour == "1800 - 1900" | hour == "1900 - 2000" ~ 'early evening'),
(hour == "2000 - 2100" | hour == "2100 - 2200" | hour == "2200 - 2300" | hour == "2300 - 0000" | hour == "0000 - 0100"~ 'late evening'))) %>%
filter( (passengers>=200) | (all_avg_wait != 0) | (booth_rate<=500) )
ggplot(q7_data1,aes(x=wday, y=booth_rate, color=(ifelse(wday=='Sat'| wday=='Sun'), "gray", "white") ) +
q7_data1 <- ord %>%
mutate(booth_rate = (passengers/booths) / (all_avg_wait / 60),
time_of_day=
case_when(
(hour == "0100 - 0200" | hour == "0200 - 0300" | hour == "0300 - 0400" | hour == "0400 - 0500" ~ 'overnight'),
(hour == "0500 - 0600" | hour == "0600 - 0700" | hour == "0700 - 0800" ~ 'early morning'),
(hour == "0800 - 0900" | hour == "0900 - 1000" | hour == "1000 - 1100" | hour == "1100 - 1200" ~ 'morning'),
(hour == "1200 - 1300" | hour == "1300 - 1400" | hour == "1400 - 1500" | hour == "1500 - 1600" | hour == "1600 - 1700" ~'afternoon'),
(hour == "1700 - 1800" | hour == "1800 - 1900" | hour == "1900 - 2000" ~ 'early evening'),
(hour == "2000 - 2100" | hour == "2100 - 2200" | hour == "2200 - 2300" | hour == "2300 - 0000" | hour == "0000 - 0100"~ 'late evening'))) %>%
filter( (passengers>=200) | (all_avg_wait != 0) | (booth_rate<=500) )
ggplot(q7_data1,aes(x=wday, y=booth_rate, color=(wday) +
geom_boxplot()
q7_data1 <- ord %>%
mutate(booth_rate = (passengers/booths) / (all_avg_wait / 60),
time_of_day=
case_when(
(hour == "0100 - 0200" | hour == "0200 - 0300" | hour == "0300 - 0400" | hour == "0400 - 0500" ~ 'overnight'),
(hour == "0500 - 0600" | hour == "0600 - 0700" | hour == "0700 - 0800" ~ 'early morning'),
(hour == "0800 - 0900" | hour == "0900 - 1000" | hour == "1000 - 1100" | hour == "1100 - 1200" ~ 'morning'),
(hour == "1200 - 1300" | hour == "1300 - 1400" | hour == "1400 - 1500" | hour == "1500 - 1600" | hour == "1600 - 1700" ~'afternoon'),
(hour == "1700 - 1800" | hour == "1800 - 1900" | hour == "1900 - 2000" ~ 'early evening'),
(hour == "2000 - 2100" | hour == "2100 - 2200" | hour == "2200 - 2300" | hour == "2300 - 0000" | hour == "0000 - 0100"~ 'late evening'))) %>%
filter( (passengers>=200) | (all_avg_wait != 0) | (booth_rate<=500) )
ggplot(q7_data1,aes(x=wday, y=booth_rate, color=(wday)) +
geom_boxplot()
count_na <- function(x)
{
return ( sum(is.na(x) ) )
}
data %>%
summarise_all(count_na)
dates <- data["date"] %>%
distinct() %>%
unlist()
data
data["date"]
data
count_na <- function(x)
{
return ( sum(is.na(x) ) )
}
q2_data %>%
summarise_all(count_na)
count_na <- function(x)
{
return ( sum(is.na(x) ) )
}
q2_data <- ord %>%
summarise_all(count_na)
dates <- q2_data["date"] %>%
distinct() %>%
unlist()
missing_dates <- dates
date_seq <- seq(ymd("2016-01-01"), ymd("2020-06-30"), by = 1)
date_seq[!date_seq %in% missing_dates]
dates
missing_dates
missing_dates
dates
date_seq <- seq(ymd("2016-01-01"), ymd("2020-06-30"), by = 1)
date_seq[!date_seq %in% missing_dates]
date_seq
date_seq[!date_seq %in% missing_dates]
q2_data <- summarise_all(count_na)
count_na <- function(x)
{
return ( sum(is.na(x) ) )
}
q2_data <- summarise_all(count_na(ord))
count_na(ord)
ord %>%
summarize_all(count_na)
ord["date"]
ord["date"] %>%
distinct()
ord["date"] %>%
distinct() %>%
unlist()
count_na <- function(x)
{
return ( sum(is.na(x) ) )
}
ord %>%
summarize_all(count_na)
dates <- ord["date"] %>%
distinct() %>%
unlist()
missing_dates <- dates
date_seq <- seq(ymd("2016-01-01"), ymd("2020-06-30"), by = 1)
date_seq[!date_seq %in% missing_dates]
q7_data1 <- ord %>%
mutate(booth_rate = (passengers/booths) / (all_avg_wait / 60),
time_of_day=
case_when(
(hour == "0100 - 0200" | hour == "0200 - 0300" | hour == "0300 - 0400" | hour == "0400 - 0500" ~ 'overnight'),
(hour == "0500 - 0600" | hour == "0600 - 0700" | hour == "0700 - 0800" ~ 'early morning'),
(hour == "0800 - 0900" | hour == "0900 - 1000" | hour == "1000 - 1100" | hour == "1100 - 1200" ~ 'morning'),
(hour == "1200 - 1300" | hour == "1300 - 1400" | hour == "1400 - 1500" | hour == "1500 - 1600" | hour == "1600 - 1700" ~'afternoon'),
(hour == "1700 - 1800" | hour == "1800 - 1900" | hour == "1900 - 2000" ~ 'early evening'),
(hour == "2000 - 2100" | hour == "2100 - 2200" | hour == "2200 - 2300" | hour == "2300 - 0000" | hour == "0000 - 0100"~ 'late evening'))) %>%
filter( (passengers>=200) | (all_avg_wait != 0) | (booth_rate<=500) )
ggplot(q7_data1, aes(x=wday, y=booths,color=wday) +
geom_boxplot()
knitr::opts_chunk$set(echo = TRUE,message=FALSE)
library(tidyverse)
library(scales)
library(lubridate)
source("../../scripts/viridis.R")
Sys.setlocale("LC_TIME", "English_United States.1252")
ord_2016 <- read.csv("../../data/ORD-2016.csv")
ord_2017 <- read.csv("../../data/ORD-2017.csv")
ord_2018 <- read.csv("../../data/ORD-2018.csv")
ord_2019 <- read.csv("../../data/ORD-2019.csv")
ord_2020 <- read.csv("../../data/ORD-2020.csv")
ord_2016 <- ord_2016 %>% mutate(date=mdy(date))
ord_2017 <- ord_2017 %>% mutate(date=mdy(date))
ord_2018 <- ord_2018 %>% mutate(date=mdy(date))
ord_2019 <- ord_2019 %>% mutate(date=ymd(date))
ord_2020 <- ord_2020 %>% mutate(date=ymd(date))
ord <- bind_rows(ord_2016, ord_2017, ord_2018, ord_2019, ord_2020)
ord <- ord %>%
mutate(year=year(date), month=month(date, label=TRUE), day=day(date), wday=wday(date, label=TRUE)) %>%
relocate(year, .after=date) %>%
relocate(month, .after=year) %>%
relocate(day, .after=month) %>%
relocate(wday, .after=day) %>%
select(-terminal) %>%
rename(passengers=all_total, flights=all_flights, booths=all_booths) %>%
arrange(date, hour)
rm(ord_2016, ord_2017, ord_2018, ord_2019, ord_2020)
str(ord)
count_na <- function(x)
{
return ( sum(is.na(x) ) )
}
ord %>%
summarize_all(count_na)
dates <- ord["date"] %>%
distinct() %>%
unlist()
missing_dates <- dates
date_seq <- seq(ymd("2016-01-01"), ymd("2020-06-30"), by = 1)
date_seq[!date_seq %in% missing_dates]
ord_summary <- ord %>%
group_by(year) %>%
summarize(tot_flights=sum(flights), tot_passengers=sum(passengers)) %>%
select(year, tot_flights, tot_passengers)
ord_summary
ord_summary2 <- ord %>%
group_by(year, month) %>%
summarize(tot_passengers=sum(passengers))
ggplot(ord_summary2, aes(x=month, y=tot_passengers, fill=year)) +
geom_col(position = "dodge") +
xlab("Month") +
ylab("Total Passengers") +
ggtitle("Number of Passengers Per Month (2016 ~ 2020)")
scale_y_continuous(label=comma)
weekend_data <- ord %>%
mutate(weekend=ifelse(wday=="Sat" | wday=="Sun", "TRUE", "FALSE")) %>%
select(year, weekend, wday, us_avg_wait, non_us_avg_wait)
ggplot(weekend_data,aes(x=us_avg_wait, y=non_us_avg_wait, color=weekend)) +
geom_point() +
geom_smooth(method="lm") +
facet_wrap(~year) +
scale_color_discrete(name = "Weekend & Weekdays", labels = c("TRUE" = "Weekend","FALSE" = "Weekday"))
data <- ord %>%
group_by(year) %>%
summarize(us=mean(us_avg_wait), non_us=mean(non_us_avg_wait)) %>%
select(year, us, non_us)
data
data <- ord %>%
group_by(year) %>%
summarize(us=mean(us_avg_wait), non_us=mean(non_us_avg_wait)) %>%
select(year, us, non_us)
data
q7_data1 <- ord %>%
mutate(booth_rate = (passengers/booths) / (all_avg_wait / 60),
time_of_day=
case_when(
(hour == "0100 - 0200" | hour == "0200 - 0300" | hour == "0300 - 0400" | hour == "0400 - 0500" ~ 'overnight'),
(hour == "0500 - 0600" | hour == "0600 - 0700" | hour == "0700 - 0800" ~ 'early morning'),
(hour == "0800 - 0900" | hour == "0900 - 1000" | hour == "1000 - 1100" | hour == "1100 - 1200" ~ 'morning'),
(hour == "1200 - 1300" | hour == "1300 - 1400" | hour == "1400 - 1500" | hour == "1500 - 1600" | hour == "1600 - 1700" ~'afternoon'),
(hour == "1700 - 1800" | hour == "1800 - 1900" | hour == "1900 - 2000" ~ 'early evening'),
(hour == "2000 - 2100" | hour == "2100 - 2200" | hour == "2200 - 2300" | hour == "2300 - 0000" | hour == "0000 - 0100"~ 'late evening'))) %>%
filter( (passengers>=200) | (all_avg_wait != 0) | (booth_rate<=500) )
ggplot(q7_data1, aes(x=wday, y=booths,color=wday) +
geom_boxplot()
q7_data1 <- ord %>%
mutate(booth_rate = (passengers/booths) / (all_avg_wait / 60),
time_of_day=
case_when(
(hour == "0100 - 0200" | hour == "0200 - 0300" | hour == "0300 - 0400" | hour == "0400 - 0500" ~ 'overnight'),
(hour == "0500 - 0600" | hour == "0600 - 0700" | hour == "0700 - 0800" ~ 'early morning'),
(hour == "0800 - 0900" | hour == "0900 - 1000" | hour == "1000 - 1100" | hour == "1100 - 1200" ~ 'morning'),
(hour == "1200 - 1300" | hour == "1300 - 1400" | hour == "1400 - 1500" | hour == "1500 - 1600" | hour == "1600 - 1700" ~'afternoon'),
(hour == "1700 - 1800" | hour == "1800 - 1900" | hour == "1900 - 2000" ~ 'early evening'),
(hour == "2000 - 2100" | hour == "2100 - 2200" | hour == "2200 - 2300" | hour == "2300 - 0000" | hour == "0000 - 0100"~ 'late evening'))) %>%
filter( (passengers>=200) | (all_avg_wait != 0) | (booth_rate<=500) )
ggplot(q7_data1, aes(x=wday, y=booths,color=wday)) +
geom_boxplot()
q7_data1 <- ord %>%
mutate(booth_rate = (passengers/booths) / (all_avg_wait / 60),
time_of_day=
case_when(
(hour == "0100 - 0200" | hour == "0200 - 0300" | hour == "0300 - 0400" | hour == "0400 - 0500" ~ 'overnight'),
(hour == "0500 - 0600" | hour == "0600 - 0700" | hour == "0700 - 0800" ~ 'early morning'),
(hour == "0800 - 0900" | hour == "0900 - 1000" | hour == "1000 - 1100" | hour == "1100 - 1200" ~ 'morning'),
(hour == "1200 - 1300" | hour == "1300 - 1400" | hour == "1400 - 1500" | hour == "1500 - 1600" | hour == "1600 - 1700" ~'afternoon'),
(hour == "1700 - 1800" | hour == "1800 - 1900" | hour == "1900 - 2000" ~ 'early evening'),
(hour == "2000 - 2100" | hour == "2100 - 2200" | hour == "2200 - 2300" | hour == "2300 - 0000" | hour == "0000 - 0100"~ 'late evening'))) %>%
mutate(time_of_day_v2 = case_when(time_of_day == "overnight" ~ 1,
time_of_day == "early morning" ~ 2,
time_of_day == "morning" ~ 3,
time_of_day == "afternoon" ~ 4,
time_of_day == "early evening" ~ 5,
time_of_day == "late evening" ~ 6)) %>%
arrange(time_of_day_v2) %>%
mutate(time_of_day = as.factor(time_of_day)) %>%
mutate(weekend = ifelse(wday == "Sat" | wday == "Sun", "TRUE", "FALSE")) %>%
select(time_of_day, everything()) %>%
filter( (passengers>=200) | (all_avg_wait != 0) | (booth_rate<=500) )
ggplot(q7_data1, aes(x=wday, y=booths,color=wday)) +
geom_boxplot(aes(fill = weekend), position = "dodge") +
facet_wrap(~reorder(time_of_day, time_of_day2)) +
scale_fill_manual(values = c("white", "gray"))
q7_data1 <- ord %>%
mutate(booth_rate = (passengers/booths) / (all_avg_wait / 60),
time_of_day=
case_when(
(hour == "0100 - 0200" | hour == "0200 - 0300" | hour == "0300 - 0400" | hour == "0400 - 0500" ~ 'overnight'),
(hour == "0500 - 0600" | hour == "0600 - 0700" | hour == "0700 - 0800" ~ 'early morning'),
(hour == "0800 - 0900" | hour == "0900 - 1000" | hour == "1000 - 1100" | hour == "1100 - 1200" ~ 'morning'),
(hour == "1200 - 1300" | hour == "1300 - 1400" | hour == "1400 - 1500" | hour == "1500 - 1600" | hour == "1600 - 1700" ~'afternoon'),
(hour == "1700 - 1800" | hour == "1800 - 1900" | hour == "1900 - 2000" ~ 'early evening'),
(hour == "2000 - 2100" | hour == "2100 - 2200" | hour == "2200 - 2300" | hour == "2300 - 0000" | hour == "0000 - 0100"~ 'late evening'))) %>%
mutate(time_of_day_v2 = case_when(time_of_day == "overnight" ~ 1,
time_of_day == "early morning" ~ 2,
time_of_day == "morning" ~ 3,
time_of_day == "afternoon" ~ 4,
time_of_day == "early evening" ~ 5,
time_of_day == "late evening" ~ 6)) %>%
arrange(time_of_day_v2) %>%
mutate(time_of_day = as.factor(time_of_day)) %>%
mutate(weekend = ifelse(wday == "Sat" | wday == "Sun", "TRUE", "FALSE")) %>%
select(time_of_day, everything()) %>%
filter( (passengers>=200) | (all_avg_wait != 0) | (booth_rate<=500) )
ggplot(q7_data1, aes(x=wday, y=booths,color=wday)) +
geom_boxplot(aes(fill = weekend), position = "dodge") +
facet_wrap(~reorder(time_of_day, time_of_day_v2)) +
scale_fill_manual(values = c("white", "gray"))
q7_data1 <- ord %>%
mutate(booth_rate = (passengers/booths) / (all_avg_wait / 60),
time_of_day=
case_when(
(hour == "0100 - 0200" | hour == "0200 - 0300" | hour == "0300 - 0400" | hour == "0400 - 0500" ~ 'overnight'),
(hour == "0500 - 0600" | hour == "0600 - 0700" | hour == "0700 - 0800" ~ 'early morning'),
(hour == "0800 - 0900" | hour == "0900 - 1000" | hour == "1000 - 1100" | hour == "1100 - 1200" ~ 'morning'),
(hour == "1200 - 1300" | hour == "1300 - 1400" | hour == "1400 - 1500" | hour == "1500 - 1600" | hour == "1600 - 1700" ~'afternoon'),
(hour == "1700 - 1800" | hour == "1800 - 1900" | hour == "1900 - 2000" ~ 'early evening'),
(hour == "2000 - 2100" | hour == "2100 - 2200" | hour == "2200 - 2300" | hour == "2300 - 0000" | hour == "0000 - 0100"~ 'late evening'))) %>%
mutate(time_of_day_v2 = case_when(time_of_day == "overnight" ~ 1,
time_of_day == "early morning" ~ 2,
time_of_day == "morning" ~ 3,
time_of_day == "afternoon" ~ 4,
time_of_day == "early evening" ~ 5,
time_of_day == "late evening" ~ 6)) %>%
arrange(time_of_day_v2) %>%
mutate(time_of_day = as.factor(time_of_day)) %>%
mutate(weekend = ifelse(wday == "Sat" | wday == "Sun", "TRUE", "FALSE")) %>%
#select(time_of_day, everything()) %>%
filter( (passengers>=200) | (all_avg_wait != 0) | (booth_rate<=500) )
ggplot(q7_data1, aes(x=wday, y=booths,color=wday)) +
geom_boxplot(aes(fill = weekend), position = "dodge") +
facet_wrap(~reorder(time_of_day, time_of_day_v2)) +
scale_fill_manual(values = c("white", "gray"))
q7_data1 <- ord %>%
mutate(booth_rate = (passengers/booths) / (all_avg_wait / 60),
time_of_day=
case_when(
(hour == "0100 - 0200" | hour == "0200 - 0300" | hour == "0300 - 0400" | hour == "0400 - 0500" ~ 'overnight'),
(hour == "0500 - 0600" | hour == "0600 - 0700" | hour == "0700 - 0800" ~ 'early morning'),
(hour == "0800 - 0900" | hour == "0900 - 1000" | hour == "1000 - 1100" | hour == "1100 - 1200" ~ 'morning'),
(hour == "1200 - 1300" | hour == "1300 - 1400" | hour == "1400 - 1500" | hour == "1500 - 1600" | hour == "1600 - 1700" ~'afternoon'),
(hour == "1700 - 1800" | hour == "1800 - 1900" | hour == "1900 - 2000" ~ 'early evening'),
(hour == "2000 - 2100" | hour == "2100 - 2200" | hour == "2200 - 2300" | hour == "2300 - 0000" | hour == "0000 - 0100"~ 'late evening'))) %>%
mutate(time_of_day_v2 = case_when(time_of_day == "overnight" ~ 1,
time_of_day == "early morning" ~ 2,
time_of_day == "morning" ~ 3,
time_of_day == "afternoon" ~ 4,
time_of_day == "early evening" ~ 5,
time_of_day == "late evening" ~ 6)) %>%
#arrange(time_of_day_v2) %>%
mutate(time_of_day = as.factor(time_of_day)) %>%
mutate(weekend = ifelse(wday == "Sat" | wday == "Sun", "TRUE", "FALSE")) %>%
filter( (passengers>=200) | (all_avg_wait != 0) | (booth_rate<=500) )
ggplot(q7_data1, aes(x=wday, y=booths,color=wday)) +
geom_boxplot(aes(fill = weekend), position = "dodge") +
facet_wrap(~reorder(time_of_day, time_of_day_v2)) +
scale_fill_manual(values = c("white", "gray"))
q7_data1 <- ord %>%
mutate(booth_rate = (passengers/booths) / (all_avg_wait / 60),
time_of_day=
case_when(
(hour == "0100 - 0200" | hour == "0200 - 0300" | hour == "0300 - 0400" | hour == "0400 - 0500" ~ 'overnight'),
(hour == "0500 - 0600" | hour == "0600 - 0700" | hour == "0700 - 0800" ~ 'early morning'),
(hour == "0800 - 0900" | hour == "0900 - 1000" | hour == "1000 - 1100" | hour == "1100 - 1200" ~ 'morning'),
(hour == "1200 - 1300" | hour == "1300 - 1400" | hour == "1400 - 1500" | hour == "1500 - 1600" | hour == "1600 - 1700" ~'afternoon'),
(hour == "1700 - 1800" | hour == "1800 - 1900" | hour == "1900 - 2000" ~ 'early evening'),
(hour == "2000 - 2100" | hour == "2100 - 2200" | hour == "2200 - 2300" | hour == "2300 - 0000" | hour == "0000 - 0100"~ 'late evening'))) %>%
mutate(time_of_day_v2 = case_when(time_of_day == "overnight" ~ 1,
time_of_day == "early morning" ~ 2,
time_of_day == "morning" ~ 3,
time_of_day == "afternoon" ~ 4,
time_of_day == "early evening" ~ 5,
time_of_day == "late evening" ~ 6)) %>%
arrange(time_of_day_v2) %>%
mutate(time_of_day = as.factor(time_of_day)) %>%
mutate(weekend = ifelse(wday == "Sat" | wday == "Sun", "TRUE", "FALSE")) %>%
filter( (passengers>=200) | (all_avg_wait != 0) | (booth_rate<=500) )
ggplot(q7_data1, aes(x=wday, y=booths,color=wday)) +
geom_boxplot(aes(fill = weekend), position = "dodge") +
facet_wrap(~reorder(time_of_day, time_of_day_v2)) +
scale_fill_manual(values = c("white", "gray"))
