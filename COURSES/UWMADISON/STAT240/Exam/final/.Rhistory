month = month(as.Date(start_date, '%m/%d/%Y')))
trip
print.data.frame(head(trip,6))
trip <- read_csv("../../data/trip.csv") %>%
rename(id = `Trip ID`,
duration = `Duration`,
start_date = `Start Date`,
end_date = `End Date`,
start_station = `Start Station`,
end_station = `End Station`,
start_terminal = `Start Terminal`,
end_terminal = `End Terminal`,
bike = `Bike #`,
subscriber = `Subscriber Type`,
zip = `Zip Code`) %>%
mutate(year = year(as.Date(start_date, '%m/%d/%Y')),
month = month(as.Date(start_date, '%m/%d/%Y')))
trip
print.data.frame(head(trip,6))
trip %>%
group_by(month) %>%
summarize(max duration = max(duration),
trip <- read_csv("../../data/trip.csv") %>%
rename(id = `Trip ID`,
duration = `Duration`,
start_date = `Start Date`,
end_date = `End Date`,
start_station = `Start Station`,
end_station = `End Station`,
start_terminal = `Start Terminal`,
end_terminal = `End Terminal`,
bike = `Bike #`,
subscriber = `Subscriber Type`,
zip = `Zip Code`) %>%
mutate(year = year(as.Date(start_date, '%m/%d/%Y')),
month = month(as.Date(start_date, '%m/%d/%Y')))
trip
print.data.frame(head(trip,6))
trip %>%
group_by(month) %>%
summarize(max_duration = max(duration),
min_duration = min(duartion))
trip <- read_csv("../../data/trip.csv") %>%
rename(id = `Trip ID`,
duration = `Duration`,
start_date = `Start Date`,
end_date = `End Date`,
start_station = `Start Station`,
end_station = `End Station`,
start_terminal = `Start Terminal`,
end_terminal = `End Terminal`,
bike = `Bike #`,
subscriber = `Subscriber Type`,
zip = `Zip Code`) %>%
mutate(year = year(as.Date(start_date, '%m/%d/%Y')),
month = month(as.Date(start_date, '%m/%d/%Y')))
trip
print.data.frame(head(trip,6))
trip %>%
group_by(month) %>%
summarize(max_duration = max(duration),
min_duration = min(duration))
trip %>%
filter(str_detect(start_station, "Caltrain"))
trip_3 <- trip %>%
mutate(season = case_when(
month == 1 ~ 'Winter',
month == 2 ~ 'Winter',
month == 3 ~ 'Spring',
month == 4 ~ 'Spring',
month == 5 ~ 'Spring',
month == 6 ~ 'Summer',
month == 7 ~ 'Summer',
month == 8 ~ 'Summer',
month == 9 ~ 'Fall',
month == 10 ~ 'Fall',
month == 11 ~ 'Fall',
month == 12 ~ 'Winter')
))
trip_3 <- trip %>%
mutate(season = case_when(
month == 1 ~ 'Winter',
month == 2 ~ 'Winter',
month == 3 ~ 'Spring',
month == 4 ~ 'Spring',
month == 5 ~ 'Spring',
month == 6 ~ 'Summer',
month == 7 ~ 'Summer',
month == 8 ~ 'Summer',
month == 9 ~ 'Fall',
month == 10 ~ 'Fall',
month == 11 ~ 'Fall',
month == 12 ~ 'Winter'
))
trip_3 <- trip %>%
mutate(season = case_when(
month == 1 ~ 'Winter',
month == 2 ~ 'Winter',
month == 3 ~ 'Spring',
month == 4 ~ 'Spring',
month == 5 ~ 'Spring',
month == 6 ~ 'Summer',
month == 7 ~ 'Summer',
month == 8 ~ 'Summer',
month == 9 ~ 'Fall',
month == 10 ~ 'Fall',
month == 11 ~ 'Fall',
month == 12 ~ 'Winter'
))
trip_3
trip_3 <- trip %>%
mutate(season = case_when(
month == 1 ~ 'Winter',
month == 2 ~ 'Winter',
month == 3 ~ 'Spring',
month == 4 ~ 'Spring',
month == 5 ~ 'Spring',
month == 6 ~ 'Summer',
month == 7 ~ 'Summer',
month == 8 ~ 'Summer',
month == 9 ~ 'Fall',
month == 10 ~ 'Fall',
month == 11 ~ 'Fall',
month == 12 ~ 'Winter'
)) %>%
group_by(season)
trip_3
trip_3 <- trip %>%
mutate(season = case_when(
month == 1 ~ 'Winter',
month == 2 ~ 'Winter',
month == 3 ~ 'Spring',
month == 4 ~ 'Spring',
month == 5 ~ 'Spring',
month == 6 ~ 'Summer',
month == 7 ~ 'Summer',
month == 8 ~ 'Summer',
month == 9 ~ 'Fall',
month == 10 ~ 'Fall',
month == 11 ~ 'Fall',
month == 12 ~ 'Winter'
)) %>%
group_by(season) %>%
summarize(avg_duration = mean(duration))
trip_3
trip_3 <- trip %>%
mutate(season = case_when(
month == 1 ~ 'Winter',
month == 2 ~ 'Winter',
month == 3 ~ 'Spring',
month == 4 ~ 'Spring',
month == 5 ~ 'Spring',
month == 6 ~ 'Summer',
month == 7 ~ 'Summer',
month == 8 ~ 'Summer',
month == 9 ~ 'Fall',
month == 10 ~ 'Fall',
month == 11 ~ 'Fall',
month == 12 ~ 'Winter'
)) %>%
group_by(season) %>%
summarize(avg_duration = mean(duration),
n = sum(
season == 'Winter',
season == 'Spring',
season == 'Summer',
season == 'Fall')
)
trip_3
trip_3 <- trip %>%
mutate(season = case_when(
month == 1 ~ 'Winter',
month == 2 ~ 'Winter',
month == 3 ~ 'Spring',
month == 4 ~ 'Spring',
month == 5 ~ 'Spring',
month == 6 ~ 'Summer',
month == 7 ~ 'Summer',
month == 8 ~ 'Summer',
month == 9 ~ 'Fall',
month == 10 ~ 'Fall',
month == 11 ~ 'Fall',
month == 12 ~ 'Winter'
)) %>%
group_by(season) %>%
summarize(avg_duration = mean(duration),
n = sum(
season == 'Winter',
season == 'Spring',
season == 'Summer',
season == 'Fall')),
trip_3 <- trip %>%
mutate(season = case_when(
month == 1 ~ 'Winter',
month == 2 ~ 'Winter',
month == 3 ~ 'Spring',
month == 4 ~ 'Spring',
month == 5 ~ 'Spring',
month == 6 ~ 'Summer',
month == 7 ~ 'Summer',
month == 8 ~ 'Summer',
month == 9 ~ 'Fall',
month == 10 ~ 'Fall',
month == 11 ~ 'Fall',
month == 12 ~ 'Winter'
)) %>%
group_by(season) %>%
summarize(avg_duration = mean(duration),
n = sum(
season == 'Winter',
season == 'Spring',
season == 'Summer',
season == 'Fall'),
sd = sd(duration),
se = sd / sqrt(n))
trip_3
trip_3 <- trip %>%
mutate(season = case_when(
month == 1 ~ 'Winter',
month == 2 ~ 'Winter',
month == 3 ~ 'Spring',
month == 4 ~ 'Spring',
month == 5 ~ 'Spring',
month == 6 ~ 'Summer',
month == 7 ~ 'Summer',
month == 8 ~ 'Summer',
month == 9 ~ 'Fall',
month == 10 ~ 'Fall',
month == 11 ~ 'Fall',
month == 12 ~ 'Winter'
)) %>%
group_by(season) %>%
summarize(avg_duration = mean(duration),
n = sum(
season == 'Winter',
season == 'Spring',
season == 'Summer',
season == 'Fall'),
sd = sd(duration),
se = sd / sqrt(n))
trip_3
ggplot(trip_3, aes(season, avg_duration)) +
geom_point()
trip_3 <- trip %>%
mutate(season = case_when(
month == 1 ~ 'Winter',
month == 2 ~ 'Winter',
month == 3 ~ 'Spring',
month == 4 ~ 'Spring',
month == 5 ~ 'Spring',
month == 6 ~ 'Summer',
month == 7 ~ 'Summer',
month == 8 ~ 'Summer',
month == 9 ~ 'Fall',
month == 10 ~ 'Fall',
month == 11 ~ 'Fall',
month == 12 ~ 'Winter'
)) %>%
group_by(season) %>%
summarize(avg_duration = mean(duration),
n = sum(
season == 'Winter',
season == 'Spring',
season == 'Summer',
season == 'Fall'),
sd = sd(duration),
se = sd / sqrt(n))
trip_3
ggplot(trip_3, aes(season, avg_duration)) +
geom_point(size=3, color="orange")
trip_3 <- trip %>%
mutate(season = case_when(
month == 1 ~ 'Winter',
month == 2 ~ 'Winter',
month == 3 ~ 'Spring',
month == 4 ~ 'Spring',
month == 5 ~ 'Spring',
month == 6 ~ 'Summer',
month == 7 ~ 'Summer',
month == 8 ~ 'Summer',
month == 9 ~ 'Fall',
month == 10 ~ 'Fall',
month == 11 ~ 'Fall',
month == 12 ~ 'Winter'
)) %>%
group_by(season) %>%
summarize(avg_duration = mean(duration),
n = sum(
season == 'Winter',
season == 'Spring',
season == 'Summer',
season == 'Fall'),
sd = sd(duration),
se = sd / sqrt(n))
trip_3
ggplot(trip_3, aes(season, avg_duration)) +
geom_point(size=3, color="orange") +
geom_segment(trip_3, mapping = aes(x = season, xend = season, y = avg_duration - 1.96 * se, yend = avg_duration + 1.96 * se), color = "blue")
trip_3 <- trip %>%
mutate(season = case_when(
month == 1 ~ 'Winter',
month == 2 ~ 'Winter',
month == 3 ~ 'Spring',
month == 4 ~ 'Spring',
month == 5 ~ 'Spring',
month == 6 ~ 'Summer',
month == 7 ~ 'Summer',
month == 8 ~ 'Summer',
month == 9 ~ 'Fall',
month == 10 ~ 'Fall',
month == 11 ~ 'Fall',
month == 12 ~ 'Winter'
)) %>%
group_by(season) %>%
summarize(avg_duration = mean(duration),
n = sum(
season == 'Winter',
season == 'Spring',
season == 'Summer',
season == 'Fall'),
sd = sd(duration),
se = sd / sqrt(n))
trip_3
ggplot(trip_3, aes(season, avg_duration)) +
geom_point(size = 3, color = "orange") +
geom_segment(trip_3, mapping = aes(x = season, xend = season, y = avg_duration - 1.96 * se, yend = avg_duration + 1.96 * se), color = "blue", size = 2)
trip_3 <- trip %>%
mutate(season = case_when(
month == 1 ~ 'Winter',
month == 2 ~ 'Winter',
month == 3 ~ 'Spring',
month == 4 ~ 'Spring',
month == 5 ~ 'Spring',
month == 6 ~ 'Summer',
month == 7 ~ 'Summer',
month == 8 ~ 'Summer',
month == 9 ~ 'Fall',
month == 10 ~ 'Fall',
month == 11 ~ 'Fall',
month == 12 ~ 'Winter'
)) %>%
group_by(season) %>%
summarize(avg_duration = mean(duration),
n = sum(
season == 'Winter',
season == 'Spring',
season == 'Summer',
season == 'Fall'),
sd = sd(duration),
se = sd / sqrt(n))
trip_3
ggplot(trip_3, aes(season, avg_duration)) +
geom_point(size = 3, color = "orange") +
geom_segment(trip_3, mapping = aes(x = season, xend = season, y = avg_duration - 1.96 * se, yend = avg_duration + 1.96 * se), color = "blue", size = 1.5)
trip_3 <- trip %>%
mutate(season = case_when(
month == 1 ~ 'Winter',
month == 2 ~ 'Winter',
month == 3 ~ 'Spring',
month == 4 ~ 'Spring',
month == 5 ~ 'Spring',
month == 6 ~ 'Summer',
month == 7 ~ 'Summer',
month == 8 ~ 'Summer',
month == 9 ~ 'Fall',
month == 10 ~ 'Fall',
month == 11 ~ 'Fall',
month == 12 ~ 'Winter'
)) %>%
group_by(season) %>%
summarize(avg_duration = mean(duration),
n = sum(
season == 'Winter',
season == 'Spring',
season == 'Summer',
season == 'Fall'),
sd = sd(duration),
se = sd / sqrt(n))
trip_3
ggplot(trip_3, aes(season, avg_duration)) +
geom_point(size = 3, color = "orange") +
geom_segment(trip_3, mapping = aes(x = season, xend = season, y = avg_duration - 1.96 * se, yend = avg_duration + 1.96 * se), color = "blue", size = 1)
trip_3 <- trip %>%
mutate(season = case_when(
month == 1 ~ 'Winter',
month == 2 ~ 'Winter',
month == 3 ~ 'Spring',
month == 4 ~ 'Spring',
month == 5 ~ 'Spring',
month == 6 ~ 'Summer',
month == 7 ~ 'Summer',
month == 8 ~ 'Summer',
month == 9 ~ 'Fall',
month == 10 ~ 'Fall',
month == 11 ~ 'Fall',
month == 12 ~ 'Winter'
)) %>%
group_by(season) %>%
summarize(avg_duration = mean(duration),
n = sum(
season == 'Winter',
season == 'Spring',
season == 'Summer',
season == 'Fall'),
sd = sd(duration),
se = sd / sqrt(n))
trip_3
ggplot(trip_3, aes(season, avg_duration)) +
geom_point(size = 3, color = "orange") +
geom_segment(trip_3, mapping = aes(x = season, xend = season, y = avg_duration - 1.96 * se, yend = avg_duration + 1.96 * se), color = "blue", size = 1) +
geom_segment(trip_3, mapping = aes(x = season, xend = season, y = avg_duration - se, yend = avg_duration + se), color = "black", size = 1.5)
trip_3 <- trip %>%
mutate(season = case_when(
month == 1 ~ 'Winter',
month == 2 ~ 'Winter',
month == 3 ~ 'Spring',
month == 4 ~ 'Spring',
month == 5 ~ 'Spring',
month == 6 ~ 'Summer',
month == 7 ~ 'Summer',
month == 8 ~ 'Summer',
month == 9 ~ 'Fall',
month == 10 ~ 'Fall',
month == 11 ~ 'Fall',
month == 12 ~ 'Winter'
)) %>%
group_by(season) %>%
summarize(avg_duration = mean(duration),
n = sum(
season == 'Winter',
season == 'Spring',
season == 'Summer',
season == 'Fall'),
sd = sd(duration),
se = sd / sqrt(n))
trip_3
ggplot(trip_3, aes(season, avg_duration)) +
geom_point(size = 3, color = "orange") +
geom_segment(trip_3, mapping = aes(x = season, xend = season, y = avg_duration - 1.96 * se, yend = avg_duration + 1.96 * se), color = "blue", size = 1) +
geom_segment(trip_3, mapping = aes(x = season, xend = season, y = avg_duration - se, yend = avg_duration + se), color = "black", size = 1.5) +
xlab("Seasons") +
ylab("Average Duration") +
ggtitle("Average Duration of Bike Trips for Each Season")
trip_2 <- trip %>%
select(start_station, end_station)
trip_2 <- trip %>%
select(start_station, end_station)
trip_2
trip_2 <- trip %>%
group_by(start_station) %>%
select(start_station, end_station)
trip_2
trip %>%
group_by(start_station)
trip %>%
group_by(start_station) %>%
arrange(start_station)
trip_part <- trip %>%
group_by(start_station) %>%
arrange(start_station)
select(start_station, end_station)
trip_part <- trip %>%
group_by(start_station) %>%
arrange(start_station)
trip_part
trip_part <- trip %>%
group_by(start_station) %>%
arrange(start_station)
trip_2 <- pivot_wider(trip_part, names_from=start_station)
trip_part
trip_2
trip_part <- trip %>%
group_by(start_station) %>%
arrange(start_station) %>%
select(start_station, end_station, bike)
trip_2 <- pivot_wider(trip_part, names_from=start_station)
trip_part
trip_2
trip_part <- trip %>%
group_by(start_station) %>%
select(start_station, end_station, bike)
trip_2 <- pivot_wider(trip_part, names_from=start_station)
trip_part
trip_2
trip_part <- trip %>%
group_by(start_station) %>%
select(start_station, end_station, bike)
trip_2 <- pivot_wider(trip_part, names_from=start_station)
trip_part
trip_2
trip_part <- trip %>%
group_by(start_station) %>%
select(start_station, end_station, bike)
trip_2 <- pivot_wider(trip_part, id_cols= start_station ,names_from=end_station)
trip_part
trip_2
trip_part <- trip %>%
group_by(start_station) %>%
select(start_station, end_station, bike)
trip_2 <- pivot_wider(trip_part, id_cols= start_station ,values_from = end_station)
trip_part <- trip %>%
group_by(start_station) %>%
select(start_station, end_station, bike)
trip_2 <- pivot_wider(trip_part, id_cols= start_station , names_from = start_station ,values_from = end_station)
trip_part
trip_2
trip_part <- trip %>%
group_by(start_station) %>%
select(start_station, end_station, bike)
trip_2 <- pivot_wider(trip_part, id_cols= start_station , names_from = start_station ,values_from = bike)
trip_part
trip_2
